<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spin to Win: The EVENITY Jackpot</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for modern icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-dark: #465562;
            --primary-orange: #eb9f40;
            --primary-white: #ffffff;
            --primary-blue: #7b96ac;
            --shadow: 0 4px 20px rgba(70, 85, 98, 0.15);
            --radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
           /* background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-dark) 100%);*/
            background-image: url("EvenityBG.png");
            min-height: 100vh;
            color: var(--primary-dark);
            overflow-x: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary-white);
        }

        .header h1 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .tagline {
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            font-style: italic;
            color: var(--primary-orange);
            margin-bottom: 1rem;
        }

        .game-container {
            background: var(--primary-white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 2rem;
            width: 100%;
        }

        .timer-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .timer {
            text-align: center;
            color: var(--primary-dark);
            font-weight: 600;
            font-size: 1rem;
        }

        .timer-controls {
            display: flex;
            gap: 1rem;
        }
        
        .slot-machine {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .reel {
            background: var(--primary-white);
            border: 2px solid var(--primary-blue);
            border-radius: var(--radius);
            padding: 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .reel:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .reel h3 {
            color: var(--primary-dark);
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .reel-window {
            background: rgba(123, 150, 172, 0.1);
            border-radius: 8px;
            padding: 0.75rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .reel-item {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--primary-dark);
            text-align: center;
            line-height: 1.3;
            filter: blur(0);
            transition: filter 0.5s ease;
        }

        .reel.spinning .reel-item {
            animation: reelSpin 0.1s linear infinite;
            filter: blur(3px);
        }
        
        .reel.stopped .reel-item {
            animation: none;
            filter: blur(0);
        }

        @keyframes reelSpin {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100%); }
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
            margin-bottom: 2rem;
            position: relative;
        }
        
        .control-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            background: var(--primary-orange);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(235, 159, 64, 0.3);
            min-width: 120px;
            color: var(--primary-white);
        }
        
        .btn:hover {
            background: #d18a2e;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(235, 159, 64, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-cta {
            background: linear-gradient(45deg, #ffb347, #ffcc33);
            font-size: 1.1rem;
            font-weight: 700;
            padding: 1rem 2rem;
            box-shadow: 0 5px 20px rgba(255, 179, 71, 0.5);
            border: 2px solid var(--primary-white);
            color: var(--primary-white);
        }

        .btn-cta:hover {
            background: linear-gradient(45deg, #ffcc33, #ffb347);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 179, 71, 0.6);
        }

        .btn-timer-sm {
            font-size: 0.8rem;
            padding: 0.5rem 1rem;
        }
        
        .wildcard-section {
            background: rgba(235, 159, 64, 0.1);
            border: 1px solid var(--primary-orange);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .wildcard-section h3 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .wildcard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .wildcard-category {
            background: var(--primary-white);
            border: 1px solid var(--primary-blue);
            border-radius: 8px;
            padding: 1rem;
            opacity: 0;
            transform: translateY(20px);
            animation: slideIn 0.5s ease forwards;
        }
        
        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .wildcard-category:nth-child(1) { animation-delay: 0.1s; }
        .wildcard-category:nth-child(2) { animation-delay: 0.2s; }
        .wildcard-category:nth-child(3) { animation-delay: 0.3s; }
        .wildcard-category:nth-child(4) { animation-delay: 0.4s; }

        .wildcard-category h4 {
            color: var(--primary-dark);
            margin-bottom: 0.5rem;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .wildcard-result {
            background: rgba(70, 85, 98, 0.05);
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        @media (max-width: 768px) {
            .slot-machine {
                grid-template-columns: 1fr 1fr 1fr;
            }
            
            .control-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
            }
            
            .wildcard-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal {
            background: var(--primary-white);
            border-radius: var(--radius);
            padding: 2rem;
            max-width: 400px;
            text-align: center;
            box-shadow: var(--shadow);
        }
        
        .modal h4 {
            margin-bottom: 1rem;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .loader {
          border: 4px solid #f3f3f3;
          border-radius: 50%;
          border-top: 4px solid var(--primary-orange);
          width: 24px;
          height: 24px;
          animation: spin 1s linear infinite;
          margin-left: 10px;
          display: none;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
    </style>
    <!-- Google tag (gtag.js) for analytics tracking -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4GHB5ERCP2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-4GHB5ERCP2');
    </script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Spin to Win: The EVENITY Jackpot</h1>
            <p class="tagline">"Line up the winning combo. Break barriers. Build bone. Change the game."</p>
        </header>

        <div class="game-container">
            <div class="timer-section">
                <div class="timer" id="timer">Game Timer: 00:00</div>
                <div class="timer-controls">
                    <button class="btn btn-timer-sm" id="start-timer">Start Timer</button>
                    <button class="btn btn-timer-sm" id="stop-timer" disabled>Stop Timer</button>
                </div>
            </div>

            <div class="slot-machine">
                <div class="reel" id="reel1">
                    <h3>Segment</h3>
                    <div class="reel-window">
                        <div class="reel-item" id="segment-result">Click spin to start!</div>
                    </div>
                </div>
                
                <div class="reel" id="reel2">
                    <h3>Barrier</h3>
                    <div class="reel-window">
                        <div class="reel-item" id="barrier-result">Click spin to start!</div>
                    </div>
                </div>
                
                <div class="reel" id="reel3">
                    <h3>Tactic Type</h3>
                    <div class="reel-window">
                        <div class="reel-item" id="tactic-result">Click spin to start!</div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <div class="control-buttons">
                    <button class="btn btn-cta" id="spin-main">Spin Main Reels</button>
                    <button class="btn" id="spin-wildcard">Spin Wildcard</button>
                    <button class="btn" id="reset-game">Reset Game</button>
                </div>
            </div>

            <div class="wildcard-section" id="wildcard-section" style="display: none;">
                <h3><i class="fas fa-magic"></i> Wildcard Challenge</h3>
                <div class="wildcard-grid" id="wildcard-grid"></div>
            </div>
        </div>
    </div>

    <script>
        // Game data
        const gameData = {
            segments: ['Breadth', 'Inexperienced', 'Depth'],
            barriers: ['Skepticism', 'Low urgency', 'Confusion on MOA', 'Competing Priorities', 'Lack of time'],
            tacticTypes: ['Peer Activation', 'Digital Experience', 'Office-based Execution', 'Unbranded Education', 'HCP-Patient Tools'],
            wildcards: {
                'Behavioral Nudges': [
                    'Loss Aversion – Frame the message/tactic to highlight what HCPs or patients could lose by inaction.',
                    'Social Proof – Show that peers or patients are already taking action.',
                    'Cognitive Ease – Make it simple and intuitive to understand or act.',
                    'Status Signal – Position the HCP as a leader or someone who\'s ahead of the curve.',
                    'Fear of Missing Out (FOMO) – Add urgency, exclusivity, or time sensitivity.',
                    'Commitment Device – Prompt HCPs or patients to pre-commit to a next step.'
                ],
                'Budget Constraints': [
                    'Shoestring Budget ($10K) – Only low-cost tactics allowed (e.g., email, rep-triggered, social).',
                    'No Paid Media – You must rely on organic, unbranded, or peer-to-peer channels.',
                    'Go Big ($500K) – Unlimited budget—aim high with a flagship program.',
                    'Branded Off-Limits – You may not mention EVENITY by name (unbranded only).',
                    'Digital-Only – Only use digital tactics: email, social, video, website, chatbot, etc.'
                ],
                'Channel Restrictions': [
                    'No Sales Rep – The rep channel is unavailable; find new ways to engage.',
                    'EHR-Only – You must reach HCPs within their workflow (EHR, field alerts).',
                    'Peer Power – Must include a peer-to-peer or KOL-led element.',
                    'Patient Pull-Through – Include a patient activation or education element.',
                    'Event-Based Only – Your tactic must be anchored to a congress or live event.'
                ],
                'Innovation Sparks': [
                    'Use AI – Integrate AI tools (e.g., chatbot, content personalization, predictive triggers).',
                    'Gamify It – Turn your tactic into an interactive, game-like experience.',
                    'Voice or Podcast – Incorporate audio/voice into your engagement (podcast, smart speaker, etc.).',
                    'Augmented Reality (AR) – Use AR or 3D visualizations to enhance the experience.',
                    'TikTok or Reels – Create a scroll-stopping microvideo concept for HCPs or patients.'
                ]
            }
        };

        // Game state and DOM elements
        const state = {
            currentSegment: null,
            currentBarrier: null,
            currentTactic: null,
            wildcardResults: {},
            startTime: null,
            timerInterval: null,
            totalElapsedSeconds: 0 
        };
        
        const elements = {
            segmentResult: document.getElementById('segment-result'),
            barrierResult: document.getElementById('barrier-result'),
            tacticResult: document.getElementById('tactic-result'),
            spinMainBtn: document.getElementById('spin-main'),
            spinWildcardBtn: document.getElementById('spin-wildcard'),
            resetBtn: document.getElementById('reset-game'),
            wildcardSection: document.getElementById('wildcard-section'),
            wildcardGrid: document.getElementById('wildcard-grid'),
            timerElement: document.getElementById('timer'),
            reels: [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')],
            startTimerBtn: document.getElementById('start-timer'),
            stopTimerBtn: document.getElementById('stop-timer')
        };
        
        // Utility functions
        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        function startTimer() {
            if (!state.timerInterval) {
                state.startTime = Date.now() - state.totalElapsedSeconds * 1000;
                
                state.timerInterval = setInterval(updateTimer, 1000);
                elements.startTimerBtn.disabled = true;
                elements.stopTimerBtn.disabled = false;
            }
        }

        function stopGameTimer() {
             if (state.timerInterval) {
                clearInterval(state.timerInterval);
                state.timerInterval = null;
                state.totalElapsedSeconds = Math.floor((Date.now() - state.startTime) / 1000);
                elements.startTimerBtn.disabled = false;
                elements.stopTimerBtn.disabled = true;
            }
        }

        function updateTimer() {
            const elapsed = Math.floor((Date.now() - state.startTime) / 1000);
            elements.timerElement.textContent = `Game Timer: ${formatTime(elapsed)}`;
        }
        
        /**
         * Tracks a custom event using Google Analytics.
         * @param {string} eventName The name of the event to track.
         * @param {object} eventParams Optional object containing event parameters.
         */
        function trackEvent(eventName, eventParams = {}) {
            if (typeof gtag === 'function') {
                gtag('event', eventName, eventParams);
            }
        }

        // Spin animation for a single reel
        function spinReel(reelElement, resultElement, dataArray) {
            return new Promise(resolve => {
                let interval = setInterval(() => {
                    resultElement.textContent = getRandomItem(dataArray);
                }, 100);
                
                // --- FIX: Remove the 'stopped' class before spinning again
                reelElement.classList.remove('stopped');
                reelElement.classList.add('spinning');
                
                setTimeout(() => {
                    clearInterval(interval);
                    reelElement.classList.remove('spinning');
                    reelElement.classList.add('stopped');
                    resolve();
                }, 1500); // Animation duration
            });
        }
        
        // Main spin function - now spins reels one by one
        async function spinMainReels() {
            elements.spinMainBtn.disabled = true;
            elements.spinWildcardBtn.disabled = true;
            
            // Spin segment reel
            await spinReel(elements.reels[0], elements.segmentResult, gameData.segments);
            state.currentSegment = elements.segmentResult.textContent;
            
            // Spin barrier reel
            await spinReel(elements.reels[1], elements.barrierResult, gameData.barriers);
            state.currentBarrier = elements.barrierResult.textContent;
            
            // Spin tactic reel
            await spinReel(elements.reels[2], elements.tacticResult, gameData.tacticTypes);
            state.currentTactic = elements.tacticResult.textContent;
            
            // Track the 'main_spin' event with parameters
            trackEvent('main_spin', {
                'segment': state.currentSegment,
                'barrier': state.currentBarrier,
                'tactic_type': state.currentTactic
            });
            
            elements.spinMainBtn.disabled = false;
            elements.spinWildcardBtn.disabled = false;
        }

        // Wildcard spin function (FIXED)
        function spinWildcard() {
            elements.spinWildcardBtn.disabled = true;
            
            const categories = Object.keys(gameData.wildcards);
            elements.wildcardGrid.innerHTML = '';
            state.wildcardResults = {};
            
            elements.wildcardSection.style.display = 'block';
            
            categories.forEach((category, index) => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'wildcard-category';
                
                // --- FIX: Updated the icons to use Font Awesome
                let iconClass;
                switch(category) {
                    case 'Behavioral Nudges':
                        iconClass = 'fas fa-lightbulb';
                        break;
                    case 'Budget Constraints':
                        iconClass = 'fas fa-dollar-sign';
                        break;
                    case 'Channel Restrictions':
                        iconClass = 'fas fa-ban';
                        break;
                    case 'Innovation Sparks':
                        iconClass = 'fas fa-rocket';
                        break;
                }
                
                categoryDiv.innerHTML = `
                    <h4><i class="${iconClass}"></i> ${category}</h4>
                    <div class="wildcard-result">Spinning...</div>
                `;
                
                elements.wildcardGrid.appendChild(categoryDiv);
                
                setTimeout(() => {
                    const randomWildcard = getRandomItem(gameData.wildcards[category]);
                    state.wildcardResults[category] = randomWildcard;
                    categoryDiv.querySelector('.wildcard-result').textContent = randomWildcard;
                }, (index + 1) * 700);
            });
            
            setTimeout(() => {
                elements.spinWildcardBtn.disabled = false;
                
                trackEvent('wildcard_spin', state.wildcardResults);
            }, categories.length * 700 + 500);
        }
        
        // Custom modal for confirmation
        function showConfirmationModal(title, message, onConfirm) {
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal-overlay';
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <h4>${title}</h4>
                <p>${message}</p>
                <div class="modal-buttons">
                    <button class="btn" id="modal-cancel">Cancel</button>
                    <button class="btn" id="modal-confirm">Confirm</button>
                </div>
            `;
            
            modalOverlay.appendChild(modal);
            document.body.appendChild(modalOverlay);
            
            document.getElementById('modal-cancel').addEventListener('click', () => {
                document.body.removeChild(modalOverlay);
            });
            
            document.getElementById('modal-confirm').addEventListener('click', () => {
                onConfirm();
                document.body.removeChild(modalOverlay);
            });
        }
        
        // Reset game function
        function resetGame() {
            showConfirmationModal('Reset Game?', 'Are you sure you want to reset the game and clear all results?', () => {
                state.currentSegment = null;
                state.currentBarrier = null;
                state.currentTactic = null;
                state.wildcardResults = {};
                state.startTime = null;
                state.totalElapsedSeconds = 0; 
                
                stopGameTimer();
                elements.timerElement.textContent = 'Game Timer: 00:00';
                
                elements.segmentResult.textContent = 'Click spin to start!';
                elements.barrierResult.textContent = 'Click spin to start!';
                elements.tacticResult.textContent = 'Click spin to start!';
                
                elements.reels.forEach(reel => reel.classList.remove('stopped'));
                
                elements.wildcardSection.style.display = 'none';
                
                elements.spinMainBtn.disabled = false;
                elements.spinWildcardBtn.disabled = false;
                elements.startTimerBtn.disabled = false;
                elements.stopTimerBtn.disabled = true;
                
                trackEvent('game_reset');
            });
        }
        
        // Event listeners
        elements.spinMainBtn.addEventListener('click', spinMainReels);
        elements.spinWildcardBtn.addEventListener('click', spinWildcard);
        elements.resetBtn.addEventListener('click', resetGame);
        elements.startTimerBtn.addEventListener('click', startTimer);
        elements.stopTimerBtn.addEventListener('click', stopGameTimer);

        // Keyboard accessibility
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                if (e.target.classList.contains('btn')) {
                    e.preventDefault();
                    e.target.click();
                }
            }
        });
    </script>
</body>
</html>
